buildscript {
    ext {
        springBootVersion = '1.5.4.RELEASE'
    }
    ext['hibernate.version'] = '5.2.10.Final'
    repositories {
        mavenCentral()
    }
    dependencies {
//        classpath 'org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}'
        classpath 'org.springframework.boot:spring-boot-gradle-plugin:1.5.4.RELEASE'
        classpath 'io.spring.gradle:dependency-management-plugin:0.5.1.RELEASE'
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '3.5'
}

allprojects {
    version = '0.0.2'
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'idea'
    apply plugin: 'eclipse-wtp'
    apply plugin: 'org.springframework.boot'

    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'

    def defaultEncoding = 'UTF-8'
    tasks.withType(AbstractCompile).each { it.options.encoding = defaultEncoding }

    javadoc {
        options.encoding = defaultEncoding
        options.addBooleanOption('Xdoclint:none', true)
    }

    //test {
    //	include '**/model/**', '**/controller/**'
    //}

    /*
    springBoot {
        executable = true
        buildInfo()
    }
    */
    repositories {
        mavenCentral()
    }

    dependencyManagement {
        imports {
            mavenBom 'org.springframework.boot:spring-boot-starter-parent:${springBootVersion}'
        }
    }
    eclipse {
        project.natures 'org.springsource.ide.eclipse.gradle.core.nature'
        wtp {
            facet {
                facet name: 'jst.web', version: '3.1.0'
                facet name: 'java', version: '1.8'
                facet name: 'wst.jsdt.web', version: '1.0'
            }

            component {
                file {
                    withXml { provider ->
                        def module = provider.asNode().'wb-module'
                        module.'dependent-module'.findAll {
                            it.@'handle'.startsWith('module:/classpath')
                        }*.replaceNode {}
                    }
                }
            }
        }
    }
    dependencies {
        compileOnly 'org.projectlombok:lombok:1.16.16'
        /** hot swapper */
        //compile('org.springframework.boot:spring-boot-devtools')
        compile 'org.springframework.boot:spring-boot-starter-web'
        compile 'org.apache.tomcat:tomcat-jdbc:7.0.28'
        compile 'org.apache.tomcat.embed:tomcat-embed-jasper'
        compile 'javax.servlet:jstl'
        compile 'org.springframework.boot:spring-boot-starter-security'
        compile 'org.springframework.boot:spring-boot-starter-aop'
        compile 'org.springframework.boot:spring-boot-starter-cache'
        compile 'org.springframework.boot:spring-boot-starter-jdbc'
//        compile 'com.microsoft.sqlserver:mssql-jdbc:6.2.2.jre8'
        compile 'org.springframework:spring-jdbc:+'
        compile 'org.apache.commons:commons-dbcp2:2.4.0'
        compile 'mysql:mysql-connector-java:8.0.16'
        compile 'org.mybatis:mybatis:3.4.4'
        compile 'org.mybatis:mybatis-spring:1.3.0'
        compile 'com.github.pagehelper:pagehelper:5.0.0'
        compile 'org.springframework.mobile:spring-mobile-device'
        compile 'com.google.code.gson:gson:2.8.0'
        compile 'commons-collections:commons-collections'
        compile 'io.jsonwebtoken:jjwt:0.7.0'
        compile 'net.sf.ehcache:ehcache:2.10.4'
        compile 'org.apache.poi:poi:3.12'
        compile 'org.apache.poi:poi-ooxml:3.12'
        compile 'org.apache.poi:poi-ooxml-schemas:3.12'
        compile 'org.jolokia:jolokia-core:1.3.6'
//        compile 'cglib:cglib:3.2.6'
        compile 'com.google.maps:google-maps-services:0.2.6'
        compile 'org.apache.commons:commons-lang3:3.7'
        compile 'org.json:json:20180813'
        compile 'org.apache.httpcomponents:httpclient:4.5.8'
        compile("org.springframework.boot:spring-boot-starter-data-redis")
        compile("org.springframework.session:spring-session-data-redis")
//        compile group: 'org.codehaus.janino', name: 'janino', version: '2.7.8'
        testCompileOnly 'org.projectlombok:lombok:1.16.16'
        testCompile 'org.springframework.boot:spring-boot-starter-test'

        // 21.01.20 메일 발송 API 추가
        compile 'javax.mail:mail:1.4.7'
    }
}


project(':delivery-dispatch-core') {
    dependencies {
//        compile fileTree(dir: 'libs', includes: ['*.jar'])
        compile files('libs/std-cntt-common-concurrent-1.0.2.jar')
        compile files('libs/std-cntt-common-mail-1.0.2.jar')
        compile files('libs/std-cntt-common-rest-1.0.6.jar')
        compile files('libs/std-cntt-common-trace-1.0.3.jar')
    }
}

project(':delivery-dispatch-core-api') {
    dependencies {
        compileOnly project(':delivery-dispatch-core')
    }
}

project(':delivery-dispatch-core-admin') {
    dependencies {
        compile project(':delivery-dispatch-core')
        compile project(':delivery-dispatch-core-api')
    }
}

project(':delivery-dispatch-api') {
    apply plugin: 'war'
    war.archiveName 'ROOT.war'
    build.dependsOn ':delivery-dispatch-core:build'
    build.dependsOn ':delivery-dispatch-core-api:build'

    dependencies {
        compile project(':delivery-dispatch-core')
        compile project(':delivery-dispatch-core-api')
        compile 'org.tuckey:urlrewritefilter:4.0.4'
        providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
    }
}

project(':delivery-dispatch-admin') {
    apply plugin: 'war'
    war.archiveName 'ROOT.war'
    build.dependsOn ':delivery-dispatch-core:build'
    build.dependsOn ':delivery-dispatch-core-api:build'
    build.dependsOn ':delivery-dispatch-core-admin:build'

    dependencies {
        compile project(':delivery-dispatch-core')
        compile project(':delivery-dispatch-core-api')
        compile project(':delivery-dispatch-core-admin')
        compile 'org.tuckey:urlrewritefilter:4.0.4'
        compile "org.springframework.boot:spring-boot-starter-thymeleaf"
        compile "org.jfree:jfreechart:1.5.0"
        providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
    }
}


project(':delivery-dispatch-mvc') {
    apply plugin: 'war'
    war.archiveName 'ROOT.war'
    build.dependsOn ':delivery-dispatch-core:build'
    build.dependsOn ':delivery-dispatch-core-api:build'

    dependencies {
        compile project(':delivery-dispatch-core')
        compile project(':delivery-dispatch-core-api')
        compile 'org.tuckey:urlrewritefilter:4.0.4'
        compile "org.springframework.boot:spring-boot-starter-thymeleaf"
        compile "org.jfree:jfreechart:1.5.0"
        providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
    }
}